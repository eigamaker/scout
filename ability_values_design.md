# 選手能力値設計ドキュメント

## 概要
高校野球の現実を反映し、すべての選手が投手と野手の両方の能力値を持つ設計となっています。これは高校野球で選手が複数のポジションを経験することが一般的であるためです。

## 能力値の基本設計

### 世代別能力値レンジ

| 世代 | 能力値範囲 | 球速範囲 | 特徴 | 備考 |
|------|------------|----------|------|------|
| 高校生全体 | 25-100 | 125-155 km/h | 現行能力値のメイン | 甲子園出場レベル: 70-100 |
| 大学生 | 75-103 | 140-155 km/h | 高校より高いレベル | |
| 社会人 | 85-105 | 140-155 km/h | 実戦経験豊富 | |
| NPB2軍 | 95-105 | 140-155 km/h | 二軍主力レベル | |
| NPB1軍 | 100-115 | 140-160 km/h | 一軍主力レベル | |
| NPBスーパースター | 115-120 | 158-160 km/h | トップレベル | |
| MLB選手 | 115-135 | 140-165 km/h | 世界レベル | |
| MLBオールスター級 | 136-145 | 160-165 km/h | 超一流 | |
| MLBスーパースター | 146-150 | 165-170 km/h | 最高レベル | |

### 投手能力値（すべての選手が持つ）

| 能力値 | 基本範囲 | 説明 | 単位 |
|--------|----------|------|------|
| 球速 (fastballVelo) | 125-155 km/h | 投球の球速（高校生範囲） | km/h |
| 制球 (control) | 25-100 | 投球の制球力 | 0-100 |
| スタミナ (stamina) | 25-100 | 投球の持久力 | 0-100 |
| 変化 (breakAvg) | 25-100 | 変化球の質 | 0-100 |

### 野手能力値（すべての選手が持つ）

| 能力値 | 基本範囲 | 説明 | 単位 |
|--------|----------|------|------|
| パワー (batPower) | 25-100 | 打撃のパワー | 0-100 |
| バットコントロール (batControl) | 25-100 | 打撃のコントロール | 0-100 |
| 走力 (run) | 25-100 | 走塁・守備の走力 | 0-100 |
| 守備 (field) | 25-100 | 守備力 | 0-100 |
| 肩 (arm) | 25-100 | 送球の肩力 | 0-100 |

## 才能ランクとポテンシャルの関係

### 才能ランクの分布

| 才能ランク | 出現確率 | 平均ポテンシャル範囲 | 個別能力値範囲 | 到達可能レベル |
|------------|----------|---------------------|----------------|----------------|
| 1 | 49.9% | 60-75 | 50-85 | 高校生レベル |
| 2 | 25% | 70-85 | 60-95 | 大学・社会人レベル |
| 3 | 20% | 80-95 | 70-105 | NPB二軍・一軍レベル |
| 4 | 5% | 90-110 | 80-120 | NPBオールスター・MLBレベル |
| 5 | 0.1% | 100-130 | 90-150 | MLBスターレベル |

### ポテンシャルの概念

**ポテンシャル**は各能力値の**生涯を通じての最大到達可能値**を表します。

- **個別ポテンシャル**: 各能力値（制球、スタミナ、パワーなど）の個別の成長上限
- **平均ポテンシャル**: 全能力値ポテンシャルの平均値
- **才能ランク**: 選手の総合的な才能レベルを決定し、平均ポテンシャルの範囲を制御

### 能力値とポテンシャルの関係

```
現在の能力値 ≤ ポテンシャル（その能力値の上限）
```

- **高校生の能力値範囲**: 25-100（現行能力値）
- **高校生の球速範囲**: 125-155 km/h（現行球速）
- **ポテンシャル範囲**: 50-150（個別能力値の成長上限）
- **球速ポテンシャル範囲**: 125-170 km/h（球速の成長上限）

## 学年別生成戦略

### 新入生（1年生）生成
- **目標**: 3年間の成長でポテンシャル上限に到達
- **初期能力値**: 成長を逆算して設定（25-100基準）
- **成長余地**: 最大限確保

### 2年生・3年生生成
- **目標**: 既に一定の成長を遂げた状態
- **初期能力値**: 学年に応じた成長を反映
- **現実性**: 高校野球の実態に近い分布

## メインポジションによる調整

### 投手の場合
- **投手能力値**: 基本値 + 0〜20のボーナス
- **野手能力値**: 基本値のまま
- **球種**: 直球は必ず習得、他の球種（カーブ、スライダー、フォーク、チェンジアップ）はランダム習得

### 野手の場合
- **投手能力値**: 基本値のまま
- **野手能力値**: 基本値 + 0〜20のボーナス
- **球種**: なし（空のリスト）

## 隠し能力値

| 能力値 | 範囲 | 説明 |
|--------|------|------|
| 精神力 (mentalGrit) | 0.5-0.8 | 成長や試合での精神的な強さ |
| 成長スピード (growthRate) | 0.9-1.2 | 能力値の成長速度 |
| ポテンシャル (peakAbility) | 60-150 | 平均ポテンシャル値 |
| 才能ランク (talent) | 1-5 | 選手の才能レベル（1:低、5:高） |
| 成長タイプ (growthType) | early/normal/late/spurt | 成長パターン |

## ポジション適性

各選手は全ポジションに対する適性値を持ちます：

- **メインポジション**: 70-90
- **サブポジション**: 40-70

## 球種システム（投手のみ）

### 基本球種
- **直球**: 必ず習得（変化量: なし, 潜在: 15-40）
- **カーブ**: ランダム習得（変化量: 20-60, 潜在: 25-75）
- **スライダー**: ランダム習得（変化量: 20-60, 潜在: 25-75）
- **フォーク**: ランダム習得（変化量: 20-60, 潜在: 25-75）
- **チェンジアップ**: ランダム習得（変化量: 20-60, 潜在: 25-75）

## データベース保存

すべての選手の投手と野手の両方の能力値がデータベースに保存されます：

```sql
-- Playerテーブルの能力値カラム
fastball_velo: 球速
control: 制球
stamina: スタミナ
break_avg: 変化球平均
batting_power: パワー
bat_control: バットコントロール
running_speed: 走力
defense: 守備
arm: 肩力

-- 隠し能力値カラム
talent: 才能ランク
growth_type: 成長タイプ
mental_grit: 精神力
peak_ability: 平均ポテンシャル

-- PlayerPotentialsテーブル（個別ポテンシャル）
control_potential: 制球ポテンシャル
stamina_potential: スタミナポテンシャル
break_avg_potential: 変化球平均ポテンシャル
bat_power_potential: パワーポテンシャル
bat_control_potential: バットコントロールポテンシャル
run_potential: 走力ポテンシャル
field_potential: 守備ポテンシャル
arm_potential: 肩力ポテンシャル
fastball_velo_potential: 球速ポテンシャル
```

## 設計思想

1. **現実性**: 高校野球で選手が複数ポジションを経験する現実を反映
2. **多様性**: 投手でも野手能力値を持ち、野手でも投手能力値を持つことで多様な選手タイプを表現
3. **成長性**: 隠し能力値により選手の成長パターンに個性を持たせる
4. **バランス**: メインポジションに応じた調整により、専門性と汎用性のバランスを取る
5. **希少性**: 才能ランク5の選手は0.1%の希少性を持ち、特別な価値を持つ

## 今後の拡張可能性

- ポジション変更システム
- 二刀流選手の特別処理
- 能力値の相関関係（例：球速と肩力の相関）
- 成長イベントによる能力値変動
- 怪我による能力値低下
- 世代別選手の生成（大学・社会人・NPB・MLB）
- 甲子園出場選手の特別能力値調整
- ドラフトシステムとの連携
- 学年別成長システムの実装
- 成長係数の精密計算
- ポジション適性による成長調整 